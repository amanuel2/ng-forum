!function(){"use strict";angular.module("mdDataTable",["mdtTemplates","ngMaterial","ngMdIcons"])}(),function(){"use strict";function t(){return{restrict:"E",templateUrl:"/main/templates/mdtAlternateHeaders.html",transclude:!0,replace:!0,scope:!0,require:"^mdtTable",link:function(t,e,a,o){function n(){var e=o.tableDataStorageService.deleteSelectedRows();t.deleteRowCallback({rows:e})}t.deleteSelectedRows=n,t.getNumberOfSelectedRows=_.bind(o.tableDataStorageService.getNumberOfSelectedRows,o.tableDataStorageService)}}}angular.module("mdDataTable").directive("mdtAlternateHeaders",t)}(),function(){"use strict";function t(t,e,a,o){return{restrict:"E",templateUrl:"/main/templates/mdtTable.html",transclude:!0,scope:{tableCard:"=",selectableRows:"=",alternateHeaders:"=",sortableColumns:"=",deleteRowCallback:"&",selectedRowCallback:"&",saveRowCallback:"&",animateSortIcon:"=",rippleEffect:"=",paginatedRows:"=",mdtRow:"=",mdtRowPaginator:"&?",mdtRowPaginatorErrorMessage:"@",virtualRepeat:"="},controller:["$scope",function(o){function n(){i.tableDataStorageService=t.getInstance(),o.mdtRowPaginator?o.mdtPaginationHelper=a.getInstance({tableDataStorageService:i.tableDataStorageService,paginationSetting:o.paginatedRows,mdtRowOptions:o.mdtRow,mdtRowPaginatorFunction:o.mdtRowPaginator,mdtRowPaginatorErrorMessage:o.mdtRowPaginatorErrorMessage}):o.mdtPaginationHelper=e.getInstance(i.tableDataStorageService,o.paginatedRows,o.mdtRow)}function r(t){i.tableDataStorageService.addHeaderCellData(t)}var i=this;n(),i.addHeaderCell=r}],link:function(t,e,a,n,r){function i(){t.selectedRowCallback({rows:n.tableDataStorageService.getSelectedRows()})}function s(){angular.isUndefined(a.mdtRowPaginator)&&t.$watch("mdtRow",function(t){n.tableDataStorageService.storage=[],l(t.data)},!0)}function l(e){var a,o=[];_.each(e,function(e){a=_.get(e,t.mdtRow["table-row-id-key"]),o=[],_.each(t.mdtRow["column-keys"],function(t){o.push(_.get(e,t))}),n.tableDataStorageService.addRowData(a,o)})}function c(){return t.paginatedRows===!0||t.paginatedRows&&t.paginatedRows.hasOwnProperty("isEnabled")&&t.paginatedRows.isEnabled===!0?!0:!1}function d(){r(function(t){var a=[],o=[];_.each(t,function(t){var e=angular.element(t);e.hasClass("theadTrRow")?a.push(e):o.push(e)}),e.find("#reader").append(a).append(o)})}function u(e){var a=n.tableDataStorageService.getSavedRowData(e);t.saveRowCallback({row:a})}function g(t,e,a){var n=t.currentTarget.closest("td").getBoundingClientRect(),r={top:n.top,left:n.left},i={controller:"InlineEditModalCtrl",targetEvent:t,clickOutsideToClose:!0,escapeToClose:!0,focusOnOpen:!1,locals:{position:r,cellData:JSON.parse(JSON.stringify(e))}};"smallEditDialog"===e.attributes.editableField?i.templateUrl="/main/templates/smallEditDialog.html":i.templateUrl="/main/templates/largeEditDialog.html";var s=this;o.show(i).then(function(t){e.value=t,s.saveRow(a)})}t.headerData=n.tableDataStorageService.header,t.isPaginationEnabled=c,t.isAnyRowSelected=_.bind(n.tableDataStorageService.isAnyRowSelected,n.tableDataStorageService),t.onCheckboxChange=i,t.saveRow=u,t.showEditDialog=g,d(),_.isEmpty(t.mdtRow)||s()}}}t.$inject=["TableDataStorageFactory","mdtPaginationHelperFactory","mdtAjaxPaginationHelperFactory","$mdDialog"],angular.module("mdDataTable").directive("mdtTable",t)}(),function(){"use strict";function t(t,e,a,o,n){function r(){t.editFieldForm.$valid&&n.hide(a.value)}function i(){n.cancel()}o(function(){var t=$("md-dialog");t.css("position","fixed"),t.css("top",e.top),t.css("left",e.left),t.find('input[type="text"]').focus()}),t.cellData=a,t.saveRow=r,t.cancel=i}t.$inject=["$scope","position","cellData","$timeout","$mdDialog"],angular.module("mdDataTable").controller("InlineEditModalCtrl",t)}(),function(){"use strict";function t(t){function e(){this.storage=[],this.header=[],this.sortByColumnLastIndex=null,this.orderByAscending=!0}return e.prototype.addHeaderCellData=function(t){this.header.push(t)},e.prototype.addRowData=function(e,a){return a instanceof Array?void this.storage.push({rowId:e,optionList:{selected:!1,deleted:!1,visible:!0},data:a}):void t.error("`rowArray` parameter should be array")},e.prototype.getRowData=function(e){return this.storage[e]?this.storage[e].data:void t.error("row is not exists at index: "+e)},e.prototype.getRowOptions=function(e){return this.storage[e]?this.storage[e].optionList:void t.error("row is not exists at index: "+e)},e.prototype.setAllRowsSelected=function(e,a){return"undefined"==typeof e?void t.error("`isSelected` parameter is required"):void _.each(this.storage,function(t){a?t.optionList.visible&&(t.optionList.selected=e?!0:!1):t.optionList.selected=e?!0:!1})},e.prototype.reverseRows=function(){this.storage.reverse()},e.prototype.sortByColumn=function(t,e){return this.sortByColumnLastIndex===t?(this.reverseRows(),this.orderByAscending=!this.orderByAscending):(this.sortByColumnIndex(t,e),this.sortByColumnLastIndex=t,this.orderByAscending=!0),this.orderByAscending?-1:1},e.prototype.sortByColumnIndex=function(t,e){var a;a="function"==typeof e?function(a){return e(a.data[t],a,t)}:function(e){return e.data[t]};var o=_.sortBy(this.storage,a);this.storage=o},e.prototype.isAnyRowSelected=function(){return _.some(this.storage,function(t){return t.optionList.selected===!0&&t.optionList.deleted===!1})},e.prototype.getNumberOfSelectedRows=function(){var t=_.countBy(this.storage,function(t){return t.optionList.selected===!0&&t.optionList.deleted===!1?"selected":"unselected"});return t.selected?t.selected:0},e.prototype.deleteSelectedRows=function(){var t=[];return _.each(this.storage,function(e){e.optionList.selected&&e.optionList.deleted===!1&&(e.rowId?t.push(e.rowId):t.push(e.data),e.optionList.deleted=!0)}),t},e.prototype.getSelectedRows=function(){var t=[];return _.each(this.storage,function(e){e.optionList.selected&&e.optionList.deleted===!1&&(e.rowId?t.push(e.rowId):t.push(e.data))}),t},e.prototype.getSavedRowData=function(t){var e=[];return _.each(t.data,function(t){e.push(t.value)}),e},{getInstance:function(){return new e}}}t.$inject=["$log"],angular.module("mdDataTable").factory("TableDataStorageFactory",t)}(),function(){"use strict";function t(){function t(t){this.tableDataStorageService=t.tableDataStorageService,this.rowOptions=t.mdtRowOptions,this.paginatorFunction=t.mdtRowPaginatorFunction,this.mdtRowPaginatorErrorMessage=t.mdtRowPaginatorErrorMessage||"Ajax error during loading contents.",t.paginationSetting&&t.paginationSetting.hasOwnProperty("rowsPerPageValues")&&t.paginationSetting.rowsPerPageValues.length>0?this.rowsPerPageValues=t.paginationSetting.rowsPerPageValues:this.rowsPerPageValues=[10,20,30,50,100],this.rowsPerPage=this.rowsPerPageValues[0],this.page=1,this.totalResultCount=0,this.totalPages=0,this.isLoading=!1,this.fetchPage(this.page)}return t.prototype.getStartRowIndex=function(){return(this.page-1)*this.rowsPerPage},t.prototype.getEndRowIndex=function(){return this.getStartRowIndex()+this.rowsPerPage-1},t.prototype.getTotalRowsCount=function(){return this.totalPages},t.prototype.getRows=function(){return this.tableDataStorageService.storage},t.prototype.previousPage=function(){var t=this;this.page>1&&this.fetchPage(this.page-1).then(function(){t.page--})},t.prototype.nextPage=function(){var t=this;this.page<this.totalPages&&this.fetchPage(this.page+1).then(function(){t.page++})},t.prototype.fetchPage=function(t){this.isLoading=!0;var e=this;return this.paginatorFunction({page:t,pageSize:this.rowsPerPage}).then(function(t){e.tableDataStorageService.storage=[],e.setRawDataToStorage(e,t.results,e.rowOptions["table-row-id-key"],e.rowOptions["column-keys"]),e.totalResultCount=t.totalResultCount,e.totalPages=Math.ceil(t.totalResultCount/e.rowsPerPage),e.isLoadError=!1,e.isLoading=!1},function(){e.tableDataStorageService.storage=[],e.isLoadError=!0,e.isLoading=!1})},t.prototype.setRawDataToStorage=function(t,e,a,o){var n,r=[];_.each(e,function(e){n=_.get(e,a),r=[],_.each(o,function(t){r.push({attributes:{editableField:!1},value:_.get(e,t)})}),t.tableDataStorageService.addRowData(n,r)})},t.prototype.setRowsPerPage=function(t){this.rowsPerPage=t,this.page=1,this.fetchPage(this.page)},{getInstance:function(e,a,o,n){return new t(e,a,o,n)}}}angular.module("mdDataTable").service("mdtAjaxPaginationHelperFactory",t)}(),function(){"use strict";function t(){function t(t,e){this.tableDataStorageService=t,e&&e.hasOwnProperty("rowsPerPageValues")&&e.rowsPerPageValues.length>0?this.rowsPerPageValues=e.rowsPerPageValues:this.rowsPerPageValues=[10,20,30,50,100],this.rowsPerPage=this.rowsPerPageValues[0],this.page=1}return t.prototype.calculateVisibleRows=function(){var t=this;_.each(this.tableDataStorageService.storage,function(e,a){a>=t.getStartRowIndex()&&a<=t.getEndRowIndex()?e.optionList.visible=!0:e.optionList.visible=!1})},t.prototype.getStartRowIndex=function(){return(this.page-1)*this.rowsPerPage},t.prototype.getEndRowIndex=function(){return this.getStartRowIndex()+this.rowsPerPage-1},t.prototype.getTotalRowsCount=function(){return this.tableDataStorageService.storage.length},t.prototype.getRows=function(){return this.calculateVisibleRows(),this.tableDataStorageService.storage},t.prototype.previousPage=function(){this.page>1&&this.page--},t.prototype.nextPage=function(){var t=Math.ceil(this.getTotalRowsCount()/this.rowsPerPage);this.page<t&&this.page++},t.prototype.setRowsPerPage=function(t){this.rowsPerPage=t,this.page=1},{getInstance:function(e,a){return new t(e,a)}}}angular.module("mdDataTable").service("mdtPaginationHelperFactory",t)}(),function(){"use strict";var t={ALIGN_RULE:{ALIGN_LEFT:"left",ALIGN_RIGHT:"right"}};angular.module("mdDataTable").value("ColumnOptionProvider",t)}(),function(){"use strict";function t(t){function e(e){return e===t.ALIGN_RULE.ALIGN_RIGHT?"rightAlignedColumn":"leftAlignedColumn"}var a=this;a.getColumnAlignClass=e}t.$inject=["ColumnOptionProvider"],angular.module("mdDataTable").service("ColumnAlignmentHelper",t)}(),function(){"use strict";function t(t){return{restrict:"E",replace:!0,transclude:!0,require:"^mdtRow",link:function(e,a,o,n,r){var i={htmlContent:o.htmlContent?o.htmlContent:!1,editableField:o.editableField?o.editableField:!1,editableFieldTitle:o.editableFieldTitle?o.editableFieldTitle:!1,editableFieldMaxLength:o.editableFieldMaxLength?o.editableFieldMaxLength:!1};r(function(a){if(o.htmlContent)n.addToRowDataStorage(a,i);else{var r=t(a.html().replace("{{","").replace("}}",""))(e.$parent);n.addToRowDataStorage(r,i)}})}}}t.$inject=["$parse"],angular.module("mdDataTable").directive("mdtCell",t)}(),function(){"use strict";function t(){return{restrict:"E",transclude:!0,require:"^mdtTable",scope:{tableRowId:"="},controller:["$scope",function(t){function e(e,a){t.rowDataStorage.push({value:e,attributes:a})}var a=this;a.addToRowDataStorage=e,t.rowDataStorage=[]}],link:function(t,e,a,o,n){function r(){n(function(t){e.append(t)})}r(),o.tableDataStorageService.addRowData(t.tableRowId,t.rowDataStorage)}}}angular.module("mdDataTable").directive("mdtRow",t)}(),function(){"use strict";function t(t){return{restrict:"E",transclude:!0,replace:!0,scope:{alignRule:"@",sortBy:"=",columnDefinition:"@"},require:["^mdtTable"],link:function(e,a,o,n,r){var i=n[0];r(function(a){var o;o=-1!==a.html().indexOf("{{")?t(a.html().replace("{{","").replace("}}",""))(e.$parent):a.html(),i.addHeaderCell({alignRule:e.alignRule,sortBy:e.sortBy,columnDefinition:e.columnDefinition,columnName:o})})}}}t.$inject=["$parse"],angular.module("mdDataTable").directive("mdtColumn",t)}(),function(){"use strict";function t(){return{restrict:"E",templateUrl:"/main/templates/mdtGeneratedHeaderCellContent.html",replace:!0,scope:!1,link:function(){}}}angular.module("mdDataTable").directive("mdtGeneratedHeaderCellContent",t)}(),function(){"use strict";function t(){return{restrict:"E",replace:!0,transclude:!0,require:"^mdtTable",scope:!0,link:function(t,e,a,o,n){function r(){n(function(t){e.append(t)})}r()}}}angular.module("mdDataTable").directive("mdtHeaderRow",t)}(),function(){"use strict";function t(t){return{restrict:"A",scope:{mdtAddAlignClass:"="},link:function(e,a){var o=t.getColumnAlignClass(e.mdtAddAlignClass);a.addClass(o)}}}t.$inject=["ColumnAlignmentHelper"],angular.module("mdDataTable").directive("mdtAddAlignClass",t)}(),function(){"use strict";function t(){return{restrict:"A",link:function(t,e,a){t.$watch(a.mdtAddHtmlContentToCell,function(t){e.empty(),e.append(t.value)},!0)}}}angular.module("mdDataTable").directive("mdtAddHtmlContentToCell",t)}(),function(){"use strict";function t(){return{restrict:"A",scope:!1,link:function(t,e){t.animateSortIcon&&e.addClass("animate-sort-icon")}}}angular.module("mdDataTable").directive("mdtAnimateSortIconHandler",t)}(),function(){"use strict";function t(){return{restrict:"A",scope:!1,require:"^mdtTable",link:function(t,e,a,o){t.selectAllRows=!1,t.$watch("selectAllRows",function(e){o.tableDataStorageService.setAllRowsSelected(e,t.isPaginationEnabled())})}}}angular.module("mdDataTable").directive("mdtSelectAllRowsHandler",t)}(),function(){"use strict";function t(){return{restrict:"A",scope:!1,require:"^mdtTable",link:function(t,e,a,o){function n(){t.sortableColumns&&t.$apply(function(){t.direction=o.tableDataStorageService.sortByColumn(i,t.headerRowData.sortBy)})}function r(){return o.tableDataStorageService.sortByColumnLastIndex===i}var i=t.$index;t.isSorted=r,t.direction=1,e.on("click",n),t.$on("$destroy",function(){e.off("click",n)})}}}angular.module("mdDataTable").directive("mdtSortHandler",t)}(),function(){"use strict";function t(t){return{restrict:"E",templateUrl:"/main/templates/mdtCardFooter.html",transclude:!0,replace:!0,scope:!0,require:["^mdtTable"],link:function(t){t.rowsPerPage=t.mdtPaginationHelper.rowsPerPage,t.$watch("rowsPerPage",function(e,a){t.mdtPaginationHelper.setRowsPerPage(e)})}}}t.$inject=["$timeout"],angular.module("mdDataTable").directive("mdtCardFooter",t)}(),function(){"use strict";function t(){return{restrict:"E",templateUrl:"/main/templates/mdtCardHeader.html",transclude:!0,replace:!0,scope:!0,require:["^mdtTable"],link:function(t){t.isTableCardEnabled=!1,t.tableCard&&t.tableCard.visible!==!1&&(t.isTableCardEnabled=!0)}}}angular.module("mdDataTable").directive("mdtCardHeader",t)}();